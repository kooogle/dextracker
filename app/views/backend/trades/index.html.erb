<%= content_for(:title,  '交易追踪 | 交易记录') %>
<section class="content-header">
  <h1>
    交易记录 <small>信息预览</small>
  </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="ion-home"></i> Dashboard</a></li>
    <li class="active"><i class="ion-ios-book"></i> 交易记录</li>
  </ol>
</section>
<section class="content">
  <div class="box box-primary">
    <div class="box-header">
      <a href="<%= backend_exchange_markets_path(@market.exchange_id) %>" class="btn bg-navy btn-flat"><i class="icon ion-arrow-left-a"></i> 市场列表</a>
      <a href="<%= pull_backend_market_trades_path(@market.id) %>" class="btn bg-primary btn-flat"><i class="fa fa-history"></i> 同步交易</a>
    </div>
    <div class="box-body">
      <div class="row">
        <div class="col-sm-12">
          <table id="example1" class="table table-bordered table-striped dataTable" role="grid" aria-describedby="example1_info">
            <thead>
            <tr>
              <th tabindex="0" aria-controls="example1" style="text-align: center">交易市场</th>
              <th tabindex="0" aria-controls="example1" style="text-align: center">类型</th>
              <th tabindex="0" aria-controls="example1" style="text-align: center">数量</th>
              <th tabindex="0" aria-controls="example1" style="text-align: center">单价</th>
              <th tabindex="0" aria-controls="example1" style="text-align: center">总计</th>
              <th tabindex="0" aria-controls="example1" style="text-align: center">时间</th>
            </tr>
            </thead>
            <tbody>
              <% @trades.each do |item| %>
                <tr style="text-align: center">
                  <td><%= item.market.detail %></td>
                  <td><%= item.cate %></td>
                  <td><%= item.amount %>&nbsp;<%= item.market.base %></td>
                  <td><%= item.price %>&nbsp;<%= item.market.quote %></td>
                  <td><%= item.total %>&nbsp;<%= item.market.quote %></td>
                  <td><%= item.completed_at.long %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-5">
          <div class="dataTables_info" id="example1_info" role="status" aria-live="polite"><h5>总计：【<%= @trades.count %>】</h5></div>
        </div>
        <div>
          <span>买单总数： <%= @market.trades.bids.map(&:amount).sum %></span>
          <span>买单总计： <%= @market.trades.bids.map(&:total).sum %></span><br>
          <span>卖单总数： <%= @market.trades.asks.map(&:amount).sum %></span>
          <span>卖单总计： <%= @market.trades.asks.map(&:total).sum %></span>
        </div>
        <div class="col-sm-12">
          <div class="dataTables_paginate paging_simple_numbers">
            <%= will_paginate @trades, :class=>'apple_pagination' %>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>